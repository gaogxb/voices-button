# 自动生成语音配置文件

## 新增 MP3 文件需要修改的文件清单

当你在 `public/voices/` 目录下新增 MP3 文件时，需要修改以下文件：

### 1. 如果新增了新的分类文件夹

**文件**: `setting/translate/category.json`

需要添加分类信息：
```json
{
  "name": "分类名",
  "translate": {
    "zh-CN": "中文翻译",
    "en-US": "英文翻译"
  },
  "hide": false  // 可选，是否隐藏
}
```

### 2. 对于每个分类文件夹下的 MP3 文件

**文件**: `setting/translate/XX_voices.json` (XX 是分类序号，如 01, 02)

需要添加语音信息：
```json
{
  "name": "语音名",
  "path": "分类文件夹名/文件名.mp3",
  "date": "2024-01-01",
  "translate": {
    "zh-CN": "中文翻译",
    "en-US": "英文翻译"
  },
  "category": "分类名",
  "mark": {  // 可选，语音来源信息
    "title": "来源标题",
    "time": "59:33~59:34",
    "url": "https://..."
  }
}
```

## 使用自动生成脚本

### 运行脚本

```bash
yarn generate-voices
# 或
npm run generate-voices
```

### 脚本功能

1. **自动扫描** `public/voices/` 目录下的所有分类文件夹
2. **自动识别** 分类名（从文件夹名提取，去掉序号前缀）
3. **自动生成** `category.json` 文件（如果分类不存在）
4. **自动生成** `XX_voices.json` 文件（每个分类对应一个文件）
5. **智能合并** 保留已存在的配置（翻译、mark 等信息）
6. **自动更新** 已存在语音的路径（如果文件移动了）
7. **自动清理** 已删除的语音和分类

### 文件夹命名规则

- 分类文件夹格式：`序号_分类名`
  - 例如：`1_猫猫名言`、`2_日常对话`
  - 序号用于排序和生成对应的 JSON 文件名

### 生成后的工作

脚本会自动生成基础配置，但你需要：

1. **检查翻译**：打开生成的 JSON 文件，更新 `translate` 字段的中英文翻译
2. **添加来源信息**（可选）：为语音添加 `mark` 字段，记录来源
3. **重新构建**：运行 `yarn build` 使更改生效

### 示例

假设你有以下文件结构：
```
public/voices/
  ├── 1_猫猫名言/
  │   ├── 好耶.mp3
  │   └── 太棒了.mp3
  └── 2_日常对话/
      └── 早上好.mp3
```

运行脚本后会生成：
- `setting/translate/category.json` - 包含"猫猫名言"和"日常对话"两个分类
- `setting/translate/01_voices.json` - 包含"好耶"和"太棒了"两个语音
- `setting/translate/02_voices.json` - 包含"早上好"一个语音

### 注意事项

- 脚本会保留已存在的配置，不会覆盖你手动添加的翻译和 mark 信息
- 如果文件被移动或重命名，脚本会自动更新路径
- 如果文件被删除，脚本会从配置中移除对应的语音
- 翻译字段默认使用文件名，需要手动更新为合适的翻译

